
     <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <title>Field Buddy Pro v5.0 - Flow Edition</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0B1121">
  
  <!-- Libraries (lazy loaded) -->
  <script>
    // Lazy load heavy libs only when needed
    window.loadPDF = () => import('https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js');
    window.loadChart = () => import('https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js');
    window.loadSignature = () => import('https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js');
  </script>
  
  <style>
    /* ==================== DESIGN TOKENS ==================== */
    :root {
      /* Dark Theme */
      --bg-primary: #0B1121;
      --bg-secondary: #151B2D;
      --bg-tertiary: #1E2638;
      --bg-elevated: #242D42;
      --bg-card: #1A2332;
      
      /* Accents */
      --cyan: #00D9FF;
      --cyan-dark: #00A8CC;
      --orange: #FF6B35;
      --purple: #A855F7;
      --green: #10B981;
      --yellow: #FCD34D;
      --red: #EF4444;
      --blue: #3B82F6;
      
      /* Status Colors */
      --success: #10B981;
      --warning: #FCD34D;
      --danger: #EF4444;
      --info: #3B82F6;
      
      /* Text */
      --text-primary: #F8FAFC;
      --text-secondary: #CBD5E1;
      --text-tertiary: #94A3B8;
      --text-muted: #64748B;
      
      /* Glass Effects */
      --glass-bg: rgba(30, 38, 56, 0.8);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      
      /* Shadows */
      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
      --shadow-md: 0 8px 16px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 16px 32px rgba(0, 0, 0, 0.5);
      --shadow-xl: 0 24px 48px rgba(0, 0, 0, 0.6);
      
      /* Radius */
      --radius-sm: 6px;
      --radius: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;
      
      /* Spacing */
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 12px;
      --space-lg: 16px;
      --space-xl: 24px;
      --space-2xl: 32px;
      --space-3xl: 48px;
      
      /* Transitions */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);
      
      /* Touch Targets (Android GS24 optimized) */
      --touch-min: 48px;
      --touch-comfortable: 56px;
    }
    
    /* ==================== RESET & BASE ==================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    html {
      font-size: 16px; /* Base for rem calculations */
      -webkit-text-size-adjust: 100%;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 0.875rem; /* 14px */
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      position: relative;
    }
    
    /* ==================== LAYOUT ==================== */
    .app {
      display: flex;
      min-height: 100vh;
      position: relative;
    }
    
    /* Sidebar - Collapsible on mobile */
    .sidebar {
      width: 280px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--glass-border);
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      z-index: 1000;
      transition: transform var(--transition-slow);
      transform: translateX(0);
    }
    
    .sidebar.collapsed {
      transform: translateX(-100%);
    }
    
    /* Main Content */
    .main {
      flex: 1;
      margin-left: 280px;
      min-height: 100vh;
      transition: margin-left var(--transition-slow);
    }
    
    .main.full-width {
      margin-left: 0;
    }
    
    /* Header */
    .header {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      padding: 0 var(--space-xl);
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: var(--shadow);
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: var(--space-lg);
    }
    
    .menu-toggle {
      display: none; /* Show on mobile */
      width: var(--touch-min);
      height: var(--touch-min);
      background: none;
      border: none;
      color: var(--text-primary);
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius);
      transition: var(--transition);
    }
    
    .menu-toggle:active {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .page-title {
      font-size: 1.25rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* Workspace */
    .workspace {
      padding: var(--space-xl);
      max-width: 1400px;
      margin: 0 auto;
    }
    
    /* ==================== SIDEBAR COMPONENTS ==================== */
    .sidebar-header {
      padding: var(--space-2xl);
      border-bottom: 1px solid var(--glass-border);
      background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }
    
    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.4);
      animation: pulse-glow 3s ease-in-out infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(0, 217, 255, 0.4); }
      50% { box-shadow: 0 0 30px rgba(0, 217, 255, 0.6); }
    }
    
    .logo-text h1 {
      font-size: 1.125rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1.2;
    }
    
    .logo-text .version {
      font-size: 0.6875rem;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }
    
    /* Navigation */
    .nav {
      padding: var(--space-xl) 0;
    }
    
    .nav-section {
      margin-bottom: var(--space-xl);
    }
    
    .nav-section-title {
      padding: var(--space-sm) var(--space-xl);
      font-size: 0.6875rem;
      font-weight: 700;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md) var(--space-xl);
      color: var(--text-secondary);
      text-decoration: none;
      cursor: pointer;
      transition: var(--transition);
      border-left: 3px solid transparent;
      font-weight: 500;
      min-height: var(--touch-min);
      position: relative;
      user-select: none;
    }
    
    .nav-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--cyan) 0%, transparent 100%);
      opacity: 0;
      transition: var(--transition);
    }
    
    .nav-item:hover {
      color: var(--cyan);
      background: rgba(0, 217, 255, 0.05);
    }
    
    .nav-item:hover::before {
      width: 100%;
      opacity: 0.1;
    }
    
    .nav-item.active {
      color: var(--cyan);
      background: rgba(0, 217, 255, 0.1);
      border-left-color: var(--cyan);
      font-weight: 600;
    }
    
    .nav-item .icon {
      font-size: 1.25rem;
      width: 28px;
      text-align: center;
      flex-shrink: 0;
    }
    
    /* ==================== CARDS ==================== */
    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      margin-bottom: var(--space-xl);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
    }
    
    .card:hover {
      box-shadow: var(--shadow-md);
      border-color: rgba(0, 217, 255, 0.2);
    }
    
    .card-header {
      padding: var(--space-xl);
      border-bottom: 1px solid var(--glass-border);
      background: rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .card-title {
      font-size: 1.125rem;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .card-body {
      padding: var(--space-xl);
    }
    
    .card-section {
      margin-bottom: var(--space-xl);
    }
    
    .card-section:last-child {
      margin-bottom: 0;
    }
    
    .section-title {
      font-size: 0.875rem;
      font-weight: 700;
      color: var(--cyan);
      margin-bottom: var(--space-md);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }
    
    .section-title::before {
      content: '';
      width: 4px;
      height: 16px;
      background: var(--cyan);
      border-radius: 2px;
    }
    
    /* ==================== FORM ELEMENTS ==================== */
    .form-grid {
      display: grid;
      gap: var(--space-lg);
    }
    
    .form-grid-2 {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
    
    .form-grid-3 {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    
    .form-group {
      display: flex;
      flex-direction: column;
    }
    
    label {
      font-size: 0.8125rem;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-xs);
    }
    
    .required::after {
      content: '*';
      color: var(--red);
      margin-left: 2px;
    }
    
    .help-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      background: var(--cyan);
      color: var(--bg-primary);
      border-radius: 50%;
      font-size: 0.625rem;
      font-weight: 700;
      cursor: help;
      position: relative;
    }
    
    input,
    select,
    textarea {
      width: 100%;
      padding: var(--space-md) var(--space-lg);
      min-height: var(--touch-min);
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      color: var(--text-primary);
      font-size: 0.875rem;
      font-family: inherit;
      transition: var(--transition);
      outline: none;
    }
    
    input:focus,
    select:focus,
    textarea:focus {
      border-color: var(--cyan);
      box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.2);
      background: var(--bg-tertiary);
    }
    
    input[readonly] {
      background: var(--bg-secondary);
      color: var(--text-tertiary);
      cursor: not-allowed;
    }
    
    input.success {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.05);
    }
    
    input.warning {
      border-color: var(--warning);
      background: rgba(252, 211, 77, 0.05);
    }
    
    input.error {
      border-color: var(--danger);
      background: rgba(239, 68, 68, 0.05);
    }
    
    textarea {
      min-height: 100px;
      resize: vertical;
      line-height: 1.6;
    }
    
    /* ==================== BUTTONS ==================== */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      padding: var(--space-md) var(--space-xl);
      min-height: var(--touch-min);
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      color: var(--text-primary);
      font-size: 0.875rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      transition: var(--transition);
      user-select: none;
      text-decoration: none;
      position: relative;
      overflow: hidden;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn:active::before {
      width: 300px;
      height: 300px;
    }
    
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      color: white;
      border-color: transparent;
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.3);
    }
    
    .btn-primary:hover:not(:disabled) {
      box-shadow: 0 0 30px rgba(0, 217, 255, 0.5);
      transform: translateY(-2px);
    }
    
    .btn-primary:active:not(:disabled) {
      transform: translateY(0);
    }
    
    .btn-success {
      background: linear-gradient(135deg, var(--green) 0%, #059669 100%);
      color: white;
      border-color: transparent;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, var(--red) 0%, #DC2626 100%);
      color: white;
      border-color: transparent;
      box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
    }
    
    .btn-secondary {
      background: var(--bg-elevated);
      border-color: var(--glass-border);
    }
    
    .btn-secondary:hover:not(:disabled) {
      background: var(--bg-tertiary);
      border-color: var(--cyan);
    }
    
    .btn-group {
      display: flex;
      gap: var(--space-sm);
      flex-wrap: wrap;
    }
    
    .btn-icon {
      min-width: var(--touch-min);
      padding: 0;
    }
    
    .btn-lg {
      min-height: var(--touch-comfortable);
      padding: var(--space-lg) var(--space-2xl);
      font-size: 1rem;
    }
    
    .btn-sm {
      min-height: 40px;
      padding: var(--space-sm) var(--space-lg);
      font-size: 0.8125rem;
    }
    
    /* ==================== QUICK ACTION CARDS ==================== */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--space-lg);
      margin-bottom: var(--space-2xl);
    }
    
    .action-card {
      background: var(--bg-card);
      border: 2px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--space-2xl);
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      min-height: 200px;
      display: flex;
      flex-direction: column;
    }
    
    .action-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--cyan) 0%, var(--purple) 100%);
      opacity: 0;
      transition: var(--transition);
    }
    
    .action-card:hover {
      border-color: var(--cyan);
      transform: translateY(-4px);
      box-shadow: 0 0 30px rgba(0, 217, 255, 0.3);
    }
    
    .action-card:hover::before {
      opacity: 1;
    }
    
    .action-card:active {
      transform: translateY(-2px);
    }
    
    .action-icon {
      width: 64px;
      height: 64px;
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      margin-bottom: var(--space-lg);
      box-shadow: 0 0 20px rgba(0, 217, 255, 0.4);
    }
    
    .action-card.orange .action-icon {
      background: linear-gradient(135deg, var(--orange) 0%, #E85D2F 100%);
      box-shadow: 0 0 20px rgba(255, 107, 53, 0.4);
    }
    
    .action-card.purple .action-icon {
      background: linear-gradient(135deg, var(--purple) 0%, #7C3AED 100%);
      box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);
    }
    
    .action-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: var(--space-sm);
      color: var(--text-primary);
    }
    
    .action-description {
      font-size: 0.875rem;
      color: var(--text-secondary);
      line-height: 1.6;
      flex: 1;
    }
    
    .action-badge {
      display: inline-block;
      padding: 4px 12px;
      background: var(--cyan);
      color: white;
      border-radius: var(--radius-full);
      font-size: 0.625rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: var(--space-md);
      align-self: flex-start;
    }
    
    /* ==================== UTILITIES ==================== */
    .hidden {
      display: none !important;
    }
    
    .mt-sm { margin-top: var(--space-sm); }
    .mt-md { margin-top: var(--space-md); }
    .mt-lg { margin-top: var(--space-lg); }
    .mt-xl { margin-top: var(--space-xl); }
    
    .mb-sm { margin-bottom: var(--space-sm); }
    .mb-md { margin-bottom: var(--space-md); }
    .mb-lg { margin-bottom: var(--space-lg); }
    .mb-xl { margin-bottom: var(--space-xl); }
    
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    
    .text-success { color: var(--success); }
    .text-warning { color: var(--warning); }
    .text-danger { color: var(--danger); }
    .text-info { color: var(--info); }
    .text-muted { color: var(--text-muted); }
    
    /* ==================== TOAST NOTIFICATIONS ==================== */
    .toast {
      position: fixed;
      bottom: var(--space-2xl);
      right: var(--space-2xl);
      background: var(--bg-elevated);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: var(--space-lg) var(--space-xl);
      box-shadow: var(--shadow-xl);
      z-index: 9999;
      min-width: 280px;
      max-width: 400px;
      opacity: 0;
      transform: translateY(20px);
      transition: var(--transition);
      pointer-events: none;
    }
    
    .toast.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
    
    .toast.success {
      background: linear-gradient(135deg, var(--cyan) 0%, var(--cyan-dark) 100%);
      color: white;
      border-color: transparent;
    }
    
    .toast.error {
      background: linear-gradient(135deg, var(--red) 0%, #DC2626 100%);
      color: white;
      border-color: transparent;
    }
    
    .toast.warning {
      background: linear-gradient(135deg, var(--orange) 0%, #E85D2F 100%);
      color: white;
      border-color: transparent;
    }
    
    /* ==================== LOADING STATES ==================== */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-top-color: white;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .skeleton {
      background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-elevated) 50%, var(--bg-tertiary) 75%);
      background-size: 200% 100%;
      animation: skeleton-loading 1.5s ease-in-out infinite;
      border-radius: var(--radius);
    }
    
    @keyframes skeleton-loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }
    
    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 1024px) {
      .sidebar {
        transform: translateX(-100%);
      }
      
      .sidebar.open {
        transform: translateX(0);
        box-shadow: var(--shadow-xl);
      }
      
      .main {
        margin-left: 0;
      }
      
      .menu-toggle {
        display: flex;
      }
      
      .form-grid-2,
      .form-grid-3 {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 640px) {
      .workspace {
        padding: var(--space-lg);
      }
      
      .header {
        padding: 0 var(--space-lg);
        height: 56px;
      }
      
      .quick-actions {
        grid.quick-actions {
        grid-template-columns: 1fr;
      }
      
      .card-header {
        padding: var(--space-lg);
      }
      
      .card-body {
        padding: var(--space-lg);
      }
      
      .toast {
        bottom: var(--space-lg);
        right: var(--space-lg);
        left: var(--space-lg);
        min-width: auto;
      }
    }
  </style>
</head>

<body>
  <div class="app">
    
    <!-- ==================== SIDEBAR ==================== -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <div class="logo-icon">üîß</div>
          <div class="logo-text">
            <h1>Field Buddy Pro</h1>
            <div class="version">v5.0 Flow Edition</div>
          </div>
        </div>
      </div>
      
      <nav class="nav">
        <div class="nav-section">
          <div class="nav-section-title">Quick Start</div>
          <button class="nav-item active" data-page="dashboard">
            <span class="icon">üè†</span>
            <span>Dashboard</span>
          </button>
          <button class="nav-item" data-page="new-job">
            <span class="icon">‚ûï</span>
            <span>New Service Call</span>
          </button>
          <button class="nav-item" data-page="continue">
            <span class="icon">‚ñ∂Ô∏è</span>
            <span>Continue Last Job</span>
          </button>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Tools</div>
          <button class="nav-item" data-page="measurements">
            <span class="icon">üìè</span>
            <span>Quick Measurements</span>
          </button>
          <button class="nav-item" data-page="materials">
            <span class="icon">üì¶</span>
            <span>Materials & Parts</span>
          </button>
          <button class="nav-item" data-page="photos">
            <span class="icon">üì∑</span>
            <span>Photo Gallery</span>
          </button>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">History</div>
          <button class="nav-item" data-page="history">
            <span class="icon">üìä</span>
            <span>Past Jobs</span>
          </button>
          <button class="nav-item" data-page="reports">
            <span class="icon">üìÑ</span>
            <span>Saved Reports</span>
          </button>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Settings</div>
          <button class="nav-item" data-page="sync">
            <span class="icon">üîÑ</span>
            <span>Sync Data</span>
          </button>
          <button class="nav-item" data-page="settings">
            <span class="icon">‚öôÔ∏è</span>
            <span>Preferences</span>
          </button>
        </div>
      </nav>
    </aside>
    
    <!-- ==================== MAIN CONTENT ==================== -->
    <main class="main" id="main">
      
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="menu-toggle" id="menu-toggle" aria-label="Toggle menu">
            ‚ò∞
          </button>
          <h2 class="page-title" id="page-title">Dashboard</h2>
        </div>
        <div class="header-right">
          <button class="btn btn-icon" id="sync-status" aria-label="Sync status" title="All data saved locally">
            üíæ
          </button>
        </div>
      </header>
      
      <!-- Workspace -->
      <div class="workspace">
        
        <!-- ==================== DASHBOARD PAGE ==================== -->
        <div id="page-dashboard" class="page-content">
          <div class="mb-xl">
            <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;">
              Welcome back, Mart√≠n! üëã
            </h1>
            <p style="color: var(--text-secondary); font-size: 1rem;">
              Let's get to work. What would you like to do?
            </p>
          </div>
          
          <div class="quick-actions">
            <div class="action-card" data-action="new-job">
              <div class="action-icon">‚ûï</div>
              <div class="action-title">Start New Job</div>
              <div class="action-description">
                Begin a fresh service call with guided workflow
              </div>
              <span class="action-badge">Quick Start</span>
            </div>
            
            <div class="action-card orange" data-action="continue">
              <div class="action-icon">‚ñ∂Ô∏è</div>
              <div class="action-title">Continue Last Job</div>
              <div class="action-description">
                Resume your most recent in-progress service call
              </div>
              <span class="action-badge" style="background: var(--orange);">Resume</span>
            </div>
            
            <div class="action-card purple" data-action="quick-measure">
              <div class="action-icon">üìè</div>
              <div class="action-title">Quick Measurements</div>
              <div class="action-description">
                Log temps & pressures without starting a full job
              </div>
              <span class="action-badge" style="background: var(--purple);">Fast Entry</span>
            </div>
          </div>
          
          <!-- Recent Jobs (INJECTION POINT 1) -->
          <div id="recent-jobs-container"></div>
          
          <!-- Quick Stats (INJECTION POINT 2) -->
          <div id="quick-stats-container"></div>
          
        </div>
        
        <!-- ==================== NEW JOB PAGE ==================== -->
        <div id="page-new-job" class="page-content hidden">
          
          <!-- Issue Type Selector (INJECTION POINT 3) -->
          <div id="issue-type-container"></div>
          
          <!-- Equipment Info (INJECTION POINT 4) -->
          <div id="equipment-info-container"></div>
          
          <!-- Dynamic Measurements (INJECTION POINT 5) -->
          <div id="measurements-container"></div>
          
          <!-- Smart Suggestions (INJECTION POINT 6) -->
          <div id="suggestions-container"></div>
          
          <!-- Photos & Notes (INJECTION POINT 7) -->
          <div id="photos-notes-container"></div>
          
          <!-- Action Buttons -->
          <div class="btn-group mt-xl">
            <button class="btn btn-secondary" id="save-draft">
              üíæ Save Draft
            </button>
            <button class="btn btn-success" id="complete-job">
              ‚úì Complete Job
            </button>
          </div>
          
        </div>
        
        <!-- ==================== CONTINUE JOB PAGE ==================== -->
        <div id="page-continue" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Resume Job</div>
            </div>
            <div class="card-body">
              <div id="continue-job-content">
                <p class="text-muted">No jobs in progress</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ==================== MEASUREMENTS PAGE ==================== -->
        <div id="page-measurements" class="page-content hidden">
          
          <!-- Quick Entry Form (INJECTION POINT 8) -->
          <div id="quick-measurements-form"></div>
          
        </div>
        
        <!-- ==================== MATERIALS PAGE ==================== -->
        <div id="page-materials" class="page-content hidden">
          
          <!-- Material Packages (INJECTION POINT 9) -->
          <div id="material-packages-container"></div>
          
          <!-- Custom Material Builder (INJECTION POINT 10) -->
          <div id="custom-materials-container"></div>
          
        </div>
        
        <!-- ==================== PHOTOS PAGE ==================== -->
        <div id="page-photos" class="page-content hidden">
          
          <!-- Photo Gallery (INJECTION POINT 11) -->
          <div id="photo-gallery-container"></div>
          
        </div>
        
        <!-- ==================== HISTORY PAGE ==================== -->
        <div id="page-history" class="page-content hidden">
          
          <!-- Job History List (INJECTION POINT 12) -->
          <div id="job-history-container"></div>
          
        </div>
        
        <!-- ==================== REPORTS PAGE ==================== -->
        <div id="page-reports" class="page-content hidden">
          
          <!-- Saved Reports (INJECTION POINT 13) -->
          <div id="saved-reports-container"></div>
          
        </div>
        
        <!-- ==================== SYNC PAGE ==================== -->
        <div id="page-sync" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Data Sync Status</div>
            </div>
            <div class="card-body">
              <div id="sync-status-content">
                <p class="text-success">‚úì All data saved locally</p>
                <p class="text-muted mt-md">Last saved: <span id="last-save-time">Never</span></p>
              </div>
              <div class="btn-group mt-lg">
                <button class="btn btn-primary" id="export-data">
                  üì§ Export All Data
                </button>
                <button class="btn btn-secondary" id="import-data">
                  üì• Import Data
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- ==================== SETTINGS PAGE ==================== -->
        <div id="page-settings" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Preferences</div>
            </div>
            <div class="card-body">
              
              <div class="card-section">
                <div class="section-title">Technician Info</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Your Name</label>
                    <input type="text" id="tech-name" value="Mart√≠n Perez">
                  </div>
                  <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="tech-phone" value="(346)451-0024">
                  </div>
                </div>
                <div class="form-group mt-md">
                  <label>Email</label>
                  <input type="email" id="tech-email" value="Mperez@villageplumbing.com">
                </div>
              </div>
              
              <div class="card-section">
                <div class="section-title">Default Values</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Default Refrigerant</label>
                    <select id="default-refrigerant">
                      <option value="R-410A" selected>R-410A</option>
                      <option value="R-22">R-22</option>
                      <option value="R-32">R-32</option>
                      <option value="R-454B">R-454B</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Measurement Units</label>
                    <select id="default-units">
                      <option value="imperial" selected>Imperial (¬∞F, PSI)</option>
                      <option value="metric">Metric (¬∞C, kPa)</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <div class="btn-group mt-xl">
                <button class="btn btn-success" id="save-settings">
                  ‚úì Save Preferences
                </button>
                <button class="btn btn-danger" id="clear-all-data">
                  üóëÔ∏è Clear All Data
                </button>
              </div>
              
            </div>
          </div>
        </div>
        
      </div>
      
    </main>
    
  </div>
  
  <!-- Toast Notification -->
  <div class="toast" id="toast" role="alert" aria-live="polite"></div>
  
  <script>
    // ==================== [INJECTION POINT A: STATE MANAGEMENT] ====================
    // ==================== STATE MANAGEMENT ====================

// Global application state
const AppState = {
  // Current user/technician
  tech: {
    name: 'Mart√≠n Perez',
    phone: '(346)451-0024',
    email: 'Mperez@villageplumbing.com'
  },
  
  // Current active job
  currentJob: null,
  
  // All jobs stored locally
  jobs: [],
  
  // App preferences
  settings: {
    defaultRefrigerant: 'R-410A',
    units: 'imperial',
    autoSave: true,
    photoQuality: 'high'
  },
  
  // UI state
  ui: {
    currentPage: 'dashboard',
    sidebarOpen: false,
    unsavedChanges: false
  }
};

// Job template structure
const createNewJob = () => ({
  id: generateUUID(),
  createdAt: new Date().toISOString(),
  updatedAt: new Date().toISOString(),
  status: 'in_progress', // in_progress, completed, draft
  
  // Customer info
  customer: {
    name: '',
    address: '',
    phone: ''
  },
  
  // Issue/complaint
  issue: {
    type: '', // no_cool, no_heat, poor_performance, noise, maintenance
    description: '',
    reportedBy: 'customer'
  },
  
  // Equipment details
  equipment: {
    type: '', // split_system, package_unit, heat_pump, furnace, mini_split
    indoor: {
      brand: '',
      model: '',
      serial: ''
    },
    outdoor: {
      brand: '',
      model: '',
      serial: ''
    },
    tonnage: '',
    refrigerant: 'R-410A',
    filterSize: '',
    ageYears: null
  },
  
  // Measurements timeline (chronological)
  measurements: [],
  
  // Photos
  photos: [],
  
  // Voice notes
  notes: [],
  
  // Materials/parts used
  materials: [],
  
  // Smart suggestions from diagnostic engine
  suggestions: [],
  
  // Final diagnosis & work performed
  diagnosis: {
    issue: '',
    cause: '',
    workPerformed: '',
    recommendations: ''
  },
  
  // Customer signature
  signature: null,
  
  // Quality score
  qualityScore: 0
});

// Add measurement to current job
const addMeasurement = (type, value, unit, label) => {
  if (!AppState.currentJob) return;
  
  const measurement = {
    id: generateUUID(),
    timestamp: new Date().toISOString(),
    type, // temp, pressure, voltage, amperage
    field: label,
    value: parseFloat(value),
    unit,
    valid: true
  };
  
  AppState.currentJob.measurements.push(measurement);
  AppState.currentJob.updatedAt = new Date().toISOString();
  AppState.ui.unsavedChanges = true;
  
  // Auto-save if enabled
  if (AppState.settings.autoSave) {
    saveToStorage();
  }
  
  return measurement;
};

// Add photo to current job
const addPhoto = (dataUrl, category = 'general') => {
  if (!AppState.currentJob) return;
  
  const photo = {
    id: generateUUID(),
    timestamp: new Date().toISOString(),
    data: dataUrl,
    category, // equipment, issue, repair, before, after
    caption: ''
  };
  
  AppState.currentJob.photos.push(photo);
  AppState.currentJob.updatedAt = new Date().toISOString();
  AppState.ui.unsavedChanges = true;
  
  if (AppState.settings.autoSave) {
    saveToStorage();
  }
  
  return photo;
};

// Update job status
const updateJobStatus = (status) => {
  if (!AppState.currentJob) return;
  
  AppState.currentJob.status = status;
  AppState.currentJob.updatedAt = new Date().toISOString();
  
  if (status === 'completed') {
    AppState.currentJob.completedAt = new Date().toISOString();
    calculateQualityScore();
  }
  
  saveToStorage();
};

// Calculate quality score based on completeness
const calculateQualityScore = () => {
  if (!AppState.currentJob) return 0;
  
  let score = 0;
  const job = AppState.currentJob;
  
  // Customer info (20 points)
  if (job.customer.name) score += 7;
  if (job.customer.address) score += 7;
  if (job.customer.phone) score += 6;
  
  // Equipment info (15 points)
  if (job.equipment.type) score += 5;
  if (job.equipment.indoor.brand) score += 5;
  if (job.equipment.indoor.model) score += 5;
  
  // Measurements (25 points)
  if (job.measurements.length >= 3) score += 10;
  if (job.measurements.length >= 6) score += 10;
  if (job.measurements.length >= 10) score += 5;
  
  // Photos (15 points)
  if (job.photos.length >= 1) score += 5;
  if (job.photos.length >= 3) score += 5;
  if (job.photos.length >= 5) score += 5;
  
  // Diagnosis (15 points)
  if (job.diagnosis.issue) score += 5;
  if (job.diagnosis.cause) score += 5;
  if (job.diagnosis.workPerformed) score += 5;
  
  // Signature (10 points)
  if (job.signature) score += 10;
  
  job.qualityScore = Math.min(score, 100);
  return job.qualityScore;
};

// Get most recent measurement by type
const getLastMeasurement = (type) => {
  if (!AppState.currentJob) return null;
  
  const measurements = AppState.currentJob.measurements
    .filter(m => m.type === type)
    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
  
  return measurements[0] || null;
};

// Get all measurements of specific type
const getMeasurementsByType = (type) => {
  if (!AppState.currentJob) return [];
  
  return AppState.currentJob.measurements
    .filter(m => m.type === type)
    .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
};
    
    
    // ==================== [INJECTION POINT B: UTILITY FUNCTIONS] ====================// ==================== UTILITY FUNCTIONS ====================

// Generate UUID v4
const generateUUID = () => {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    const r = Math.random() * 16 | 0;
    const v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
};

// Format date/time
const formatDateTime = (isoString) => {
  const date = new Date(isoString);
  return date.toLocaleString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
    hour: 'numeric',
    minute: '2-digit',
    hour12: true
  });
};

// Format date only
const formatDate = (isoString) => {
  const date = new Date(isoString);
  return date.toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric'
  });
};

// Show toast notification
const showToast = (message, type = 'success') => {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.className = `toast show ${type}`;
  
  setTimeout(() => {
    toast.classList.remove('show');
  }, 3000);
};

// Get element by ID (shorthand)
const $ = (id) => document.getElementById(id);

// Query selector (shorthand)
const $$ = (selector) => document.querySelectorAll(selector);

// Debounce function (for auto-save)
const debounce = (func, wait) => {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
};

// Validate number input
const isValidNumber = (value) => {
  return !isNaN(parseFloat(value)) && isFinite(value);
};

// Clamp number between min and max
const clamp = (num, min, max) => {
  return Math.min(Math.max(num, min), max);
};

// Format temperature
const formatTemp = (value, unit = 'F') => {
  if (!isValidNumber(value)) return 'N/A';
  return `${parseFloat(value).toFixed(1)}¬∞${unit}`;
};

// Format pressure
const formatPressure = (value, unit = 'PSI') => {
  if (!isValidNumber(value)) return 'N/A';
  return `${parseFloat(value).toFixed(1)} ${unit}`;
};

// Format voltage
const formatVoltage = (value) => {
  if (!isValidNumber(value)) return 'N/A';
  return `${parseFloat(value).toFixed(1)}V`;
};

// Format amperage
const formatAmperage = (value) => {
  if (!isValidNumber(value)) return 'N/A';
  return `${parseFloat(value).toFixed(1)}A`;
};

// Get relative time (e.g., "2 hours ago")
const getRelativeTime = (isoString) => {
  const date = new Date(isoString);
  const now = new Date();
  const diffMs = now - date;
  const diffMins = Math.floor(diffMs / 60000);
  const diffHours = Math.floor(diffMs / 3600000);
  const diffDays = Math.floor(diffMs / 86400000);
  
  if (diffMins < 1) return 'Just now';
  if (diffMins < 60) return `${diffMins} min ago`;
  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`;
  if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`;
  return formatDate(isoString);
};

// Compress image (for photo storage)
const compressImage = (dataUrl, maxWidth = 1200, quality = 0.8) => {
  return new Promise((resolve) => {
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      let width = img.width;
      let height = img.height;
      
      if (width > maxWidth) {
        height = (height * maxWidth) / width;
        width = maxWidth;
      }
      
      canvas.width = width;
      canvas.height = height;
      
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0, width, height);
      
      resolve(canvas.toDataURL('image/jpeg', quality));
    };
    img.src = dataUrl;
  });
};

// Export data as JSON file
const exportJSON = (data, filename) => {
  const json = JSON.stringify(data, null, 2);
  const blob = new Blob([json], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = filename;
  link.click();
  URL.revokeObjectURL(url);
};

// Copy text to clipboard
const copyToClipboard = (text) => {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text).then(() => {
      showToast('Copied to clipboard!');
    }).catch(() => {
      showToast('Failed to copy', 'error');
    });
  } else {
    // Fallback
    const textarea = document.createElement('textarea');
    textarea.value = text;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);
    showToast('Copied to clipboard!');
  }
};
    
    
    
    // ==================== [INJECTION POINT C: NAVIGATION SYSTEM] ====================
    
    
    
    // ==================== [INJECTION POINT D: OFFLINE STORAGE] ====================
    
    
    
    // ==================== [INJECTION POINT E: ISSUE TYPE SELECTOR] ====================
    
    
    
    // ==================== [INJECTION POINT F: EQUIPMENT DATABASE] ====================
    
    
    
    // ==================== [INJECTION POINT G: MEASUREMENTS HANDLER] ====================
    
    
    
    // ==================== [INJECTION POINT H: SMART SUGGESTIONS ENGINE] ====================
    
    
    
    // ==================== [INJECTION POINT I: PHOTO MANAGEMENT] ====================
    
    
    
    // ==================== [INJECTION POINT J: MATERIAL PACKAGES] ====================
    
    
    
    // ==================== [INJECTION POINT K: REPORT GENERATION] ====================
    
    
    
    // ==================== [INJECTION POINT L: DATA EXPORT/IMPORT] ====================
    
    
    
    // ==================== [INJECTION POINT M: APP INITIALIZATION] ====================
    
    
    
  </script>
</body>
</html>