<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="description" content="Field Buddy Pro v4.5 - Professional Complete HVAC Field Service Platform">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Field Buddy Pro v4.5 - Professional Edition</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
  
  <!-- CSS remains exactly as provided above -->
  <style>
    /* All CSS from previous response stays the same */
    :root {
      --bg-primary: #0A0E1A;
      --bg-secondary: #121827;
      --bg-tertiary: #1A2035;
      --bg-elevated: #222B42;
      --bg-hover: #2A3550;
      --accent-primary: #00E5FF;
      --accent-primary-dark: #00B8CC;
      --accent-primary-glow: rgba(0, 229, 255, 0.4);
      --accent-secondary: #FF5722;
      --accent-secondary-dark: #E64A19;
      --accent-purple: #B565F7;
      --accent-gold: #FFD700;
      --success: #10B981;
      --success-glow: rgba(16, 185, 129, 0.3);
      --warning: #F59E0B;
      --warning-glow: rgba(245, 158, 11, 0.3);
      --danger: #EF4444;
      --danger-glow: rgba(239, 68, 68, 0.3);
      --info: #3B82F6;
      --info-glow: rgba(59, 130, 246, 0.3);
      --text-primary: #FFFFFF;
      --text-secondary: #CBD5E1;
      --text-tertiary: #94A3B8;
      --text-disabled: #64748B;
      --glass-bg: rgba(26, 32, 53, 0.75);
      --glass-border: rgba(255, 255, 255, 0.08);
      --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4);
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 6px 20px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 12px 32px rgba(0, 0, 0, 0.5);
      --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.6);
      --gradient-primary: linear-gradient(135deg, #00E5FF 0%, #00B8CC 100%);
      --gradient-secondary: linear-gradient(135deg, #FF5722 0%, #E64A19 100%);
      --gradient-purple: linear-gradient(135deg, #B565F7 0%, #9333EA 100%);
      --gradient-gold: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      --gradient-dark: linear-gradient(135deg, #1A2035 0%, #0A0E1A 100%);
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 12px;
      --spacing-lg: 16px;
      --spacing-xl: 24px;
      --spacing-2xl: 32px;
      --spacing-3xl: 48px;
      --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      --radius-sm: 8px;
      --radius: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 14px;
      line-height: 1.6;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    ::-webkit-scrollbar { width: 10px; height: 10px; }
    ::-webkit-scrollbar-track { background: var(--bg-secondary); border-radius: 5px; }
    ::-webkit-scrollbar-thumb { 
      background: var(--bg-elevated); 
      border-radius: 5px; 
      border: 2px solid var(--bg-secondary); 
      transition: var(--transition); 
    }
    ::-webkit-scrollbar-thumb:hover { 
      background: var(--accent-primary); 
      box-shadow: 0 0 10px var(--accent-primary-glow); 
    }
    
    .app-container { display: flex; min-height: 100vh; }
    
    .sidebar {
      width: 280px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--glass-border);
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      overflow-y: auto;
      z-index: 100;
      transition: transform var(--transition-slow);
      backdrop-filter: blur(20px);
    }
    
    .sidebar-header { 
      padding: var(--spacing-2xl); 
      border-bottom: 1px solid var(--glass-border); 
      background: var(--gradient-dark); 
    }
    
    .sidebar-logo { display: flex; align-items: center; gap: var(--spacing-lg); }
    
    .sidebar-logo-icon {
      width: 52px;
      height: 52px;
      background: var(--gradient-primary);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      box-shadow: 0 0 24px var(--accent-primary-glow);
      animation: pulse-glow 3s ease-in-out infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px var(--accent-primary-glow); transform: scale(1); }
      50% { box-shadow: 0 0 30px var(--accent-primary-glow), 0 0 40px var(--accent-primary-glow); transform: scale(1.02); }
    }
    
    .sidebar-logo-text { flex: 1; }
    
    .sidebar-title {
      font-size: 19px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.5px;
    }
    
    .sidebar-version {
      font-size: 10px;
      color: var(--text-tertiary);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      margin-top: 2px;
    }
    
    .sidebar-nav { padding: var(--spacing-xl) 0; }
    
    .nav-section { margin-bottom: var(--spacing-xl); }
    
    .nav-section-title {
      padding: var(--spacing-sm) var(--spacing-xl);
      font-size: 10px;
      font-weight: 700;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }
    
    .nav-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      padding: var(--spacing-md) var(--spacing-xl);
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      border-left: 3px solid transparent;
      font-size: 14px;
      font-weight: 500;
      position: relative;
      overflow: hidden;
      margin: 2px 0;
    }
    
    .nav-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 0;
      background: var(--gradient-primary);
      opacity: 0.08;
      transition: var(--transition);
    }
    
    .nav-item:hover {
      color: var(--accent-primary);
      background: rgba(0, 229, 255, 0.06);
      padding-left: calc(var(--spacing-xl) + 4px);
    }
    
    .nav-item:hover::before { width: 100%; }
    
    .nav-item.active {
      color: var(--accent-primary);
      background: rgba(0, 229, 255, 0.12);
      border-left-color: var(--accent-primary);
      box-shadow: inset 0 0 20px rgba(0, 229, 255, 0.15);
      padding-left: calc(var(--spacing-xl) + 4px);
    }
    
    .nav-icon { 
      font-size: 20px; 
      width: 28px; 
      text-align: center; 
      filter: drop-shadow(0 0 8px currentColor); 
    }
    
    .main-content { 
      margin-left: 280px; 
      flex: 1; 
      min-height: 100vh; 
      background: var(--bg-primary); 
    }
    
    .top-header {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      padding: 0 var(--spacing-2xl);
      height: 76px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 50;
      box-shadow: var(--shadow);
    }
    
    .header-left { display: flex; align-items: center; gap: var(--spacing-lg); }
    
    .menu-toggle {
      display: none;
      width: 44px;
      height: 44px;
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      cursor: pointer;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--text-primary);
      transition: var(--transition);
    }
    
    .menu-toggle:hover {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px var(--accent-primary-glow);
      transform: scale(1.05);
    }
    
    .header-title {
      font-size: 26px;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.5px;
    }
    
    .header-actions { display: flex; align-items: center; gap: var(--spacing-lg); }
    
    .header-user {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      padding: var(--spacing-sm) var(--spacing-lg);
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      font-size: 14px;
      font-weight: 500;
      transition: var(--transition);
      cursor: pointer;
    }
    
    .header-user:hover {
      background: var(--bg-hover);
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.2);
      transform: translateY(-1px);
    }
    
    .user-avatar {
      width: 42px;
      height: 42px;
      background: var(--gradient-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 15px;
      box-shadow: 0 0 20px var(--accent-primary-glow);
    }
    
    .workspace { 
      padding: var(--spacing-2xl); 
      max-width: 1600px; 
      margin: 0 auto; 
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: var(--spacing-xl);
      margin-bottom: var(--spacing-3xl);
    }
    
    .dashboard-tile {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--spacing-2xl);
      cursor: pointer;
      transition: var(--transition-slow);
      position: relative;
      overflow: hidden;
      min-height: 200px;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow);
    }
    
    .dashboard-tile::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
      opacity: 0;
      transition: var(--transition);
    }
    
    .dashboard-tile:hover {
      transform: translateY(-10px);
      box-shadow: var(--shadow-xl), 0 0 40px rgba(0, 229, 255, 0.3);
      border-color: var(--accent-primary);
    }
    
    .dashboard-tile:hover::before { opacity: 1; }
    
    .tile-header { 
      display: flex; 
      align-items: flex-start; 
      justify-content: space-between; 
      margin-bottom: var(--spacing-lg); 
    }
    
    .tile-icon {
      width: 60px;
      height: 60px;
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      background: var(--gradient-primary);
      box-shadow: 0 0 24px var(--accent-primary-glow);
      animation: float 4s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-12px); }
    }
    
    .tile-icon.orange { 
      background: var(--gradient-secondary); 
      box-shadow: 0 0 24px rgba(255, 87, 34, 0.5); 
    }
    
    .tile-icon.purple { 
      background: var(--gradient-purple); 
      box-shadow: 0 0 24px rgba(181, 101, 247, 0.5); 
    }
    
    .tile-icon.gold { 
      background: var(--gradient-gold); 
      box-shadow: 0 0 24px rgba(255, 215, 0, 0.5); 
    }
    
    .tile-badge {
      padding: 5px 14px;
      border-radius: 20px;
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      background: var(--gradient-primary);
      color: white;
      box-shadow: 0 0 12px var(--accent-primary-glow);
    }
    
    .tile-badge.pro { 
      background: var(--gradient-secondary); 
      box-shadow: 0 0 12px rgba(255, 87, 34, 0.5); 
    }
    
    .tile-badge.premium { 
      background: var(--gradient-purple); 
      box-shadow: 0 0 12px rgba(181, 101, 247, 0.5); 
    }
    
    .tile-content { flex: 1; }
    
    .tile-title {
      font-size: 21px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--spacing-sm);
      letter-spacing: -0.3px;
    }
    
    .tile-description { 
      font-size: 14px; 
      color: var(--text-secondary); 
      line-height: 1.6; 
    }
    
    .tile-stats {
      display: flex;
      gap: var(--spacing-lg);
      margin-top: var(--spacing-lg);
      padding-top: var(--spacing-lg);
      border-top: 1px solid var(--glass-border);
    }
    
    .tile-stat { flex: 1; }
    
    .tile-stat-value { 
      font-size: 19px; 
      font-weight: 700; 
      color: var(--accent-primary); 
      display: block; 
    }
    
    .tile-stat-label {
      font-size: 11px;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      margin-bottom: var(--spacing-xl);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
    }
    
    .card:hover { 
      box-shadow: var(--shadow-lg); 
      border-color: rgba(0, 229, 255, 0.3); 
    }
    
    .card-header {
      padding: var(--spacing-xl);
      border-bottom: 1px solid var(--glass-border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: rgba(0, 0, 0, 0.2);
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }
    
    .card-body { padding: var(--spacing-xl); }
    
    .card-section { margin-bottom: var(--spacing-xl); }
    .card-section:last-child { margin-bottom: 0; }
    
    .section-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--accent-primary);
      margin-bottom: var(--spacing-md);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }
    
    .section-title::before {
      content: '';
      width: 4px;
      height: 18px;
      background: var(--gradient-primary);
      border-radius: 2px;
      box-shadow: 0 0 10px var(--accent-primary-glow);
    }
    
    .form-grid { display: grid; gap: var(--spacing-lg); }
    .form-grid-2 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    .form-grid-3 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }
    .form-grid-4 { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
    
    .form-group { margin-bottom: 0; position: relative; }
    
    label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-secondary);
      margin-bottom: var(--spacing-sm);
      letter-spacing: 0.3px;
    }
    
    .help-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      background: var(--accent-primary);
      color: var(--bg-primary);
      border-radius: 50%;
      font-size: 10px;
      font-weight: 700;
      cursor: help;
      margin-left: 4px;
      position: relative;
      box-shadow: 0 0 10px var(--accent-primary-glow);
      transition: var(--transition);
    }
    
    .help-icon:hover { 
      transform: scale(1.1); 
      box-shadow: 0 0 15px var(--accent-primary-glow); 
    }
    
    .help-icon:hover::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 120%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-elevated);
      color: var(--text-primary);
      padding: 8px 12px;
      border-radius: var(--radius);
      font-size: 12px;
      font-weight: normal;
      white-space: nowrap;
      z-index: 1000;
      box-shadow: var(--shadow-lg);
      border: 1px solid var(--glass-border);
      animation: fadeIn 0.2s ease;
      max-width: 200px;
      white-space: normal;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateX(-50%) translateY(-5px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }
    
    input, select, textarea {
      width: 100%;
      padding: 13px var(--spacing-lg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      font-size: 14px;
      font-family: inherit;
      background: var(--bg-elevated);
      color: var(--text-primary);
      transition: var(--transition);
    }
    
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(0, 229, 255, 0.15), 0 0 20px rgba(0, 229, 255, 0.2);
      background: var(--bg-tertiary);
    }
    
    input:hover:not(:focus), select:hover:not(:focus), textarea:hover:not(:focus) { 
      border-color: rgba(0, 229, 255, 0.3); 
    }
    
    input[readonly] { 
      background: var(--bg-secondary); 
      color: var(--text-tertiary); 
      border-color: var(--bg-elevated); 
      cursor: not-allowed; 
    }
    
    input.warning { 
      border-color: var(--warning); 
      background: rgba(245, 158, 11, 0.06); 
    }
    
    input.error { 
      border-color: var(--danger); 
      background: rgba(239, 68, 68, 0.06); 
    }
    
    textarea { 
      resize: vertical; 
      min-height: 100px; 
      line-height: 1.6; 
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
      padding: 13px var(--spacing-xl);
      border: none;
      border-radius: var(--radius);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      min-height: 46px;
      position: relative;
      overflow: hidden;
      letter-spacing: 0.3px;
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .btn:active::before { width: 300px; height: 300px; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    
    .btn-primary { 
      background: var(--gradient-primary); 
      color: white; 
      box-shadow: 0 0 20px var(--accent-primary-glow); 
    }
    
    .btn-primary:hover:not(:disabled) {
      box-shadow: 0 0 30px var(--accent-primary-glow), 0 4px 12px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #10B981 0%, #059669 100%);
      color: white;
      box-shadow: 0 0 20px var(--success-glow);
    }
    
    .btn-success:hover:not(:disabled) {
      box-shadow: 0 0 30px var(--success-glow), 0 4px 12px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .btn-warning { 
      background: var(--gradient-secondary); 
      color: white; 
      box-shadow: 0 0 20px rgba(255, 87, 34, 0.4); 
    }
    
    .btn-warning:hover:not(:disabled) {
      box-shadow: 0 0 30px rgba(255, 87, 34, 0.5), 0 4px 12px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .btn-secondary { 
      background: var(--bg-elevated); 
      color: var(--text-primary); 
      border: 1px solid var(--glass-border); 
    }
    
    .btn-secondary:hover:not(:disabled) {
      background: var(--bg-hover);
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.2);
      transform: translateY(-2px);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
      color: white;
      box-shadow: 0 0 20px var(--danger-glow);
    }
    
    .btn-danger:hover:not(:disabled) {
      box-shadow: 0 0 30px var(--danger-glow), 0 4px 12px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }
    
    .btn-group { display: flex; gap: var(--spacing-sm); flex-wrap: wrap; }
    .btn-sm { padding: var(--spacing-sm) var(--spacing-lg); font-size: 12px; min-height: 38px; }
    
    .materials-category {
      margin-bottom: var(--spacing-md);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      background: var(--bg-elevated);
      transition: var(--transition);
    }
    
    .materials-category:hover { 
      border-color: var(--accent-primary); 
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.1); 
    }
    
    .category-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--spacing-lg);
      background: var(--bg-tertiary);
      cursor: pointer;
      user-select: none;
      transition: var(--transition);
      border-bottom: 1px solid var(--glass-border);
    }
    
    .category-header:hover { background: var(--bg-hover); }
    
    .category-title-group { display: flex; align-items: center; gap: var(--spacing-md); }
    
    .category-icon { 
      font-size: 26px; 
      filter: drop-shadow(0 0 10px currentColor); 
    }
    
    .category-name { 
      font-weight: 700; 
      font-size: 16px; 
      color: var(--text-primary); 
    }
    
    .category-meta { display: flex; align-items: center; gap: var(--spacing-sm); }
    
    .category-count {
      font-size: 11px;
      color: var(--text-tertiary);
      background: var(--bg-elevated);
      padding: 5px 12px;
      border-radius: 12px;
      font-weight: 600;
      border: 1px solid var(--glass-border);
    }
    
    .category-selected {
      font-size: 11px;
      color: white;
      background: var(--gradient-primary);
      padding: 5px 12px;
      border-radius: 12px;
      font-weight: 700;
      box-shadow: 0 0 12px var(--accent-primary-glow);
    }
    
    .category-arrow { 
      transition: transform 0.3s ease; 
      color: var(--text-tertiary); 
      font-size: 16px; 
    }
    
    .materials-category.expanded .category-arrow { transform: rotate(180deg); }
    
    .category-items { 
      max-height: 0; 
      overflow: hidden; 
      transition: max-height 0.3s ease; 
    }
    
    .materials-category.expanded .category-items { max-height: 10000px; }
    
    .material-item {
      padding: var(--spacing-lg);
      border-top: 1px solid var(--glass-border);
      background: var(--bg-secondary);
      transition: var(--transition);
    }
    
    .material-item:hover { 
      background: var(--bg-tertiary); 
      box-shadow: inset 0 0 20px rgba(0, 229, 255, 0.05); 
    }
    
    .material-item:first-child { border-top: none; }
    
    .material-item-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: var(--spacing-md);
    }
    
    .material-info { flex: 1; }
    
    .material-name { 
      font-weight: 600; 
      font-size: 15px; 
      color: var(--text-primary); 
      margin-bottom: 4px; 
    }
    
    .material-spec { 
      font-size: 12px; 
      color: var(--text-tertiary); 
    }
    
    .material-size-selector { 
      display: flex; 
      flex-wrap: wrap; 
      gap: var(--spacing-sm); 
      margin-top: var(--spacing-md); 
    }
    
    .size-btn {
      padding: 8px 14px;
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      position: relative;
    }
    
    .size-btn:hover {
      background: var(--bg-hover);
      border-color: var(--accent-primary);
      color: var(--accent-primary);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .size-btn.selected {
      background: var(--gradient-primary);
      border-color: var(--accent-primary);
      color: white;
      box-shadow: 0 0 15px var(--accent-primary-glow);
    }
    
    .size-btn .qty-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--danger);
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
      box-shadow: 0 0 10px var(--danger-glow);
    }
    
    .selected-material {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      padding: var(--spacing-md);
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      margin-bottom: var(--spacing-sm);
      transition: var(--transition);
    }
    
    .selected-material:hover {
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.1);
      transform: translateX(4px);
    }
    
    .selected-material-info { 
      flex: 1; 
      display: flex; 
      align-items: center; 
      gap: var(--spacing-md); 
    }
    
    .selected-material-size {
      background: var(--gradient-primary);
      color: white;
      padding: 6px 12px;
      border-radius: var(--radius);
      font-size: 13px;
      font-weight: 700;
      min-width: 80px;
      text-align: center;
      box-shadow: 0 0 10px var(--accent-primary-glow);
    }
    
    .selected-material-controls { 
      display: flex; 
      align-items: center; 
      gap: var(--spacing-sm); 
    }
    
    .selected-material-controls input { 
      width: 80px; 
      text-align: center; 
      padding: 8px; 
    }
    
    .qty-control { display: flex; align-items: center; gap: 4px; }
    
    .qty-btn {
      width: 32px;
      height: 32px;
      border-radius: var(--radius);
      background: var(--bg-tertiary);
      border: 1px solid var(--glass-border);
      color: var(--text-primary);
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .qty-btn:hover {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      box-shadow: 0 0 10px var(--accent-primary-glow);
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: var(--shadow);
    }
    
    .badge-success {
      background: rgba(16, 185, 129, 0.2);
      color: var(--success);
      border: 1px solid var(--success);
      box-shadow: 0 0 10px var(--success-glow);
    }
    
    .badge-warning {
      background: rgba(245, 158, 11, 0.2);
      color: var(--warning);
      border: 1px solid var(--warning);
      box-shadow: 0 0 10px var(--warning-glow);
    }
    
    .badge-danger {
      background: rgba(239, 68, 68, 0.2);
      color: var(--danger);
      border: 1px solid var(--danger);
      box-shadow: 0 0 10px var(--danger-glow);
    }
    
    .badge-info {
      background: rgba(59, 130, 246, 0.2);
      color: var(--info);
      border: 1px solid var(--info);
      box-shadow: 0 0 10px var(--info-glow);
    }
    
    .quality-dashboard {
      background: var(--gradient-purple);
      border-radius: var(--radius-xl);
      padding: var(--spacing-2xl);
      margin-bottom: var(--spacing-xl);
      color: white;
      box-shadow: var(--shadow-xl), 0 0 40px rgba(181, 101, 247, 0.5);
      position: relative;
      overflow: hidden;
    }
    
    .quality-dashboard::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .quality-header {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: var(--spacing-lg);
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
      z-index: 1;
    }
    
    .quality-score-large {
      font-size: 72px;
      font-weight: 700;
      text-align: center;
      margin: var(--spacing-xl) 0;
      text-shadow: 0 0 40px rgba(255, 255, 255, 0.5);
      position: relative;
      z-index: 1;
      letter-spacing: -2px;
    }
    
    .quality-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--spacing-lg);
      margin-top: var(--spacing-xl);
      position: relative;
      z-index: 1;
    }
    
    .quality-metric {
      background: rgba(255, 255, 255, 0.12);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      text-align: center;
      transition: var(--transition);
    }
    
    .quality-metric:hover { 
      background: rgba(255, 255, 255, 0.18); 
      transform: translateY(-4px); 
    }
    
    .metric-value { 
      font-size: 30px; 
      font-weight: 700; 
      margin-bottom: 4px; 
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.5); 
    }
    
    .metric-label { 
      font-size: 12px; 
      opacity: 0.95; 
      text-transform: uppercase; 
      letter-spacing: 0.5px; 
    }
    
    .diagnostic-panel {
      background: var(--gradient-dark);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--spacing-xl);
      margin: var(--spacing-xl) 0;
      box-shadow: var(--shadow-lg);
    }
    
    .diagnostic-header {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: var(--spacing-lg);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      color: var(--accent-primary);
    }
    
    .diagnostic-card {
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      margin-bottom: var(--spacing-md);
      transition: var(--transition);
    }
    
    .diagnostic-card:hover { 
      border-color: var(--accent-primary); 
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.2); 
    }
    
    .diagnostic-card:last-child { margin-bottom: 0; }
    
    .diagnostic-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-sm);
    }
    
    .diagnostic-card-title { 
      font-weight: 700; 
      font-size: 16px; 
      color: var(--text-primary); 
    }
    
    .diagnostic-recommendations {
      margin-top: var(--spacing-md);
      padding-top: var(--spacing-md);
      border-top: 1px solid var(--glass-border);
    }
    
    .diagnostic-recommendations ul { 
      margin: var(--spacing-sm) 0; 
      padding-left: var(--spacing-xl); 
      font-size: 13px; 
    }
    
    .diagnostic-recommendations li { 
      margin: var(--spacing-sm) 0; 
      color: var(--text-secondary); 
    }
    
    .photo-gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: var(--spacing-md);
      margin-top: var(--spacing-md);
    }
    
    .photo-item {
      position: relative;
      aspect-ratio: 1;
      border-radius: var(--radius-lg);
      overflow: hidden;
      border: 2px solid var(--glass-border);
      cursor: pointer;
      background: var(--bg-elevated);
      transition: var(--transition);
    }
    
    .photo-item:hover {
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.3);
      transform: scale(1.05);
    }
    
    .photo-item img { width: 100%; height: 100%; object-fit: cover; }
    
    .photo-item-actions {
      position: absolute;
      top: 8px;
      right: 8px;
      display: flex;
      gap: 4px;
      opacity: 0;
      transition: var(--transition);
    }
    
    .photo-item:hover .photo-item-actions { opacity: 1; }
    
    .photo-btn {
      width: 34px;
      height: 34px;
      border-radius: var(--radius);
      border: none;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      transition: var(--transition);
    }
    
    .photo-btn:hover { 
      background: var(--danger); 
      box-shadow: 0 0 10px var(--danger-glow); 
      transform: scale(1.1); 
    }
    
    .photo-upload {
      aspect-ratio: 1;
      border: 2px dashed var(--glass-border);
      border-radius: var(--radius-lg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background: var(--bg-elevated);
      transition: var(--transition);
    }
    
    .photo-upload:hover {
      border-color: var(--accent-primary);
      background: rgba(0, 229, 255, 0.05);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.2);
      transform: scale(1.02);
    }
    
    .signature-pad {
      width: 100%;
      height: 200px;
      border: 2px solid var(--glass-border);
      border-radius: var(--radius-lg);
      cursor: crosshair;
      background: var(--bg-elevated);
      transition: var(--transition);
    }
    
    .signature-pad:hover { 
      border-color: var(--accent-primary); 
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.2); 
    }
    
    .chart-container {
      height: 300px;
      margin: var(--spacing-lg) 0;
      position: relative;
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
    }
    
    .room-card {
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      margin-bottom: var(--spacing-md);
      transition: var(--transition);
    }
    
    .room-card:hover {
      border-color: var(--accent-primary);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.1);
    }
    
    .room-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-md);
    }
    
    .room-name {
      font-weight: 700;
      font-size: 16px;
      color: var(--text-primary);
    }
    
    .room-cfm {
      background: var(--gradient-primary);
      color: white;
      padding: 6px 14px;
      border-radius: var(--radius);
      font-size: 13px;
      font-weight: 700;
      box-shadow: 0 0 10px var(--accent-primary-glow);
    }
    
    .room-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: var(--spacing-sm);
      font-size: 12px;
      color: var(--text-tertiary);
    }
    
    .calculator-result {
      background: var(--gradient-primary);
      color: white;
      padding: var(--spacing-2xl);
      border-radius: var(--radius-xl);
      text-align: center;
      margin: var(--spacing-xl) 0;
      box-shadow: 0 0 30px var(--accent-primary-glow);
    }
    
    .result-value {
      font-size: 48px;
      font-weight: 700;
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
      margin-bottom: var(--spacing-sm);
    }
    
    .result-label {
      font-size: 14px;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .toggle-group {
      display: inline-flex;
      background: var(--bg-elevated);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      padding: 4px;
      gap: 4px;
    }
    
    .toggle-btn {
      padding: var(--spacing-sm) var(--spacing-xl);
      border: none;
      background: transparent;
      border-radius: calc(var(--radius) - 2px);
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      color: var(--text-secondary);
      min-width: 120px;
    }
    
    .toggle-btn.active {
      background: var(--gradient-primary);
      color: white;
      box-shadow: 0 0 20px var(--accent-primary-glow);
    }
    
    .status-card {
      padding: var(--spacing-lg);
      border-radius: var(--radius-lg);
      border-left: 4px solid;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: var(--spacing-md);
      backdrop-filter: blur(10px);
    }
    
    .status-card.success { 
      background: rgba(16, 185, 129, 0.1); 
      border-color: var(--success); 
      color: var(--success); 
    }
    
    .status-card.warning { 
      background: rgba(245, 158, 11, 0.1); 
      border-color: var(--warning); 
      color: var(--warning); 
    }
    
    .status-card.danger { 
      background: rgba(239, 68, 68, 0.1); 
      border-color: var(--danger); 
      color: var(--danger); 
    }
    
    .status-card.info { 
      background: rgba(59, 130, 246, 0.1); 
      border-color: var(--info); 
      color: var(--info); 
    }
    
    .toast {
      position: fixed;
      bottom: 30px;
      right: 30px;
      background: var(--bg-elevated);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      color: white;
      padding: var(--spacing-lg) var(--spacing-xl);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      z-index: 9999;
      font-size: 14px;
      font-weight: 600;
      opacity: 0;
      transform: translateY(20px);
      transition: var(--transition);
      min-width: 300px;
      text-align: center;
    }
    
    .toast.show { opacity: 1; transform: translateY(0); }
    
    .toast.success {
      background: var(--gradient-primary);
      box-shadow: var(--shadow-xl), 0 0 30px var(--accent-primary-glow);
    }
    
    .toast.danger {
      background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
      box-shadow: var(--shadow-xl), 0 0 30px var(--danger-glow);
    }
    
    .toast.warning {
      background: var(--gradient-secondary);
      box-shadow: var(--shadow-xl), 0 0 30px rgba(255, 87, 34, 0.4);
    }
    
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: var(--spacing-xl);
      animation: fadeIn 0.3s ease;
    }
    
    .modal-overlay.show { display: flex; }
    
    .modal {
      background: var(--bg-secondary);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--spacing-2xl);
      max-width: 500px;
      width: 100%;
      box-shadow: var(--shadow-xl);
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .modal-title { 
      font-size: 24px; 
      font-weight: 700; 
      margin-bottom: var(--spacing-md); 
      color: var(--text-primary); 
    }
    
    .modal-content { 
      color: var(--text-secondary); 
      margin-bottom: var(--spacing-xl); 
      line-height: 1.6; 
      font-size: 14px; 
    }
    
    .modal-actions { 
      display: flex; 
      gap: var(--spacing-sm); 
      justify-content: flex-end; 
    }
    
    .hidden { display: none !important; }
    .mt-lg { margin-top: var(--spacing-lg); }
    .mb-lg { margin-bottom: var(--spacing-lg); }
    
    .mobile-menu-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 99;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .mobile-menu-overlay.show { display: block; opacity: 1; }
    
    @media (max-width: 1024px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.mobile-open { transform: translateX(0); box-shadow: var(--shadow-xl); }
      .main-content { margin-left: 0; }
      .menu-toggle { display: flex; }
      .form-grid-2, .form-grid-3, .form-grid-4 { grid-template-columns: 1fr; }
      .quality-metrics { grid-template-columns: repeat(2, 1fr); }
      .dashboard-grid { grid-template-columns: 1fr; }
    }
    
    @media (max-width: 768px) {
      .workspace { padding: var(--spacing-lg); }
      .top-header { padding: 0 var(--spacing-lg); height: 68px; }
      .header-title { font-size: 20px; }
      .quality-metrics { grid-template-columns: 1fr; }
      .photo-gallery { grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); }
      .tile-stats { flex-direction: column; }
    }
  </style>
</head>

<body>
  <div class="app-container">
    <div class="mobile-menu-overlay" id="mobile-menu-overlay" onclick="toggleMobileMenu()"></div>
    
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <div class="sidebar-logo-icon">üîß</div>
          <div class="sidebar-logo-text">
            <div class="sidebar-title">Field Buddy Pro</div>
            <div class="sidebar-version">v4.5 Professional</div>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Main</div>
          <div class="nav-item active" onclick="switchPage('dashboard')">
            <span class="nav-icon">üè†</span>
            <span>Dashboard</span>
          </div>
          <div class="nav-item" onclick="switchPage('service')">
            <span class="nav-icon">üìã</span>
            <span>Service Calls</span>
          </div>
          <div class="nav-item" onclick="switchPage('materials')">
            <span class="nav-icon">üì¶</span>
            <span>Materials</span>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Calculators</div>
          <div class="nav-item" onclick="switchPage('duct-design')">
            <span class="nav-icon">üèóÔ∏è</span>
            <span>Duct Design</span>
          </div>
          <div class="nav-item" onclick="switchPage('cfm')">
            <span class="nav-icon">üå™Ô∏è</span>
            <span>CFM Calculator</span>
          </div>
          <div class="nav-item" onclick="switchPage('charging')">
            <span class="nav-icon">‚ùÑÔ∏è</span>
            <span>Refrigerant Charging</span>
          </div>
        </div>
        
        <div class="nav-section">
          <div class="nav-section-title">Data</div>
          <div class="nav-item" onclick="switchPage('history')">
            <span class="nav-icon">üìä</span>
            <span>History & Reports</span>
          </div>
          <div class="nav-item" onclick="saveData()">
            <span class="nav-icon">üíæ</span>
            <span>Save Progress</span>
          </div>
          <div class="nav-item" onclick="loadData()">
            <span class="nav-icon">üì•</span>
            <span>Load Saved Data</span>
          </div>
          <div class="nav-item" onclick="exportAllData()">
            <span class="nav-icon">üì§</span>
            <span>Export All Data</span>
          </div>
        </div>
      </nav>
    </aside>
    <main class="main-content">
      <header class="top-header">
        <div class="header-left">
          <button class="menu-toggle" onclick="toggleMobileMenu()">‚ò∞</button>
          <div class="header-title" id="page-title">Dashboard</div>
        </div>
        <div class="header-actions">
          <div class="header-user">
            <div class="user-avatar">MP</div>
            <span id="header-tech-name">Mart√≠n Perez</span>
          </div>
        </div>
      </header>
      
      <div class="workspace">
        <!-- DASHBOARD PAGE -->
        <div id="dashboard-page" class="page-content">
          <div style="margin-bottom: var(--spacing-2xl);">
            <h1 style="font-size: 36px; font-weight: 700; margin-bottom: var(--spacing-sm); background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: -1px;">
              Welcome Back, Mart√≠n! üëã
            </h1>
            <p style="color: var(--text-secondary); font-size: 16px;">
              Your complete professional HVAC field service management platform
            </p>
          </div>
          
          <div class="dashboard-grid">
            <div class="dashboard-tile" onclick="switchPage('service')">
              <div class="tile-header">
                <div class="tile-icon">üìã</div>
                <div class="tile-badge premium">Advanced</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">Service Calls</div>
                <div class="tile-description">
                  Complete diagnostic system with refrigerant calculations, temperature analysis, and professional reporting with AI-powered recommendations
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value" id="dash-stat-reports">0</span>
                    <span class="tile-stat-label">Reports</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value" id="dash-stat-quality">0%</span>
                    <span class="tile-stat-label">Avg Quality</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="dashboard-tile" onclick="switchPage('materials')">
              <div class="tile-header">
                <div class="tile-icon orange">üì¶</div>
                <div class="tile-badge pro">Pro+</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">Materials Catalog</div>
                <div class="tile-description">
                  Complete 2025 catalog with 500+ items - multi-size selection, real-time inventory tracking, and automatic material takeoffs
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value">500+</span>
                    <span class="tile-stat-label">Items</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value">15</span>
                    <span class="tile-stat-label">Categories</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="dashboard-tile" onclick="switchPage('duct-design')">
              <div class="tile-header">
                <div class="tile-icon purple">üèóÔ∏è</div>
                <div class="tile-badge">Premium</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">Pro Duct Design</div>
                <div class="tile-description">
                  ACCA Manual D compliant duct system design with CFM calculations, friction rate analysis, and material takeoffs
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value">‚úì</span>
                    <span class="tile-stat-label">ACCA Compliant</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value">Auto</span>
                    <span class="tile-stat-label">Material List</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="dashboard-tile" onclick="switchPage('cfm')">
              <div class="tile-header">
                <div class="tile-icon gold">üå™Ô∏è</div>
                <div class="tile-badge">Essential</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">CFM & Duct Sizing</div>
                <div class="tile-description">
                  Professional airflow and duct sizing calculators with multiple calculation methods and velocity analysis
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value">6</span>
                    <span class="tile-stat-label">Calculators</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value">Instant</span>
                    <span class="tile-stat-label">Results</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="dashboard-tile" onclick="switchPage('charging')">
              <div class="tile-header">
                <div class="tile-icon">‚ùÑÔ∏è</div>
                <div class="tile-badge premium">Pro</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">Refrigerant Charging</div>
                <div class="tile-description">
                  Advanced refrigerant charging calculator with superheat/subcool targets, PT charts, and charge adjustment recommendations
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value">4</span>
                    <span class="tile-stat-label">Refrigerants</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value">Precise</span>
                    <span class="tile-stat-label">Calculations</span>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="dashboard-tile" onclick="switchPage('history')">
              <div class="tile-header">
                <div class="tile-icon orange">üìä</div>
                <div class="tile-badge pro">Pro</div>
              </div>
              <div class="tile-content">
                <div class="tile-title">History & Reports</div>
                <div class="tile-description">
                  Access all saved reports, track statistics, and manage your service history with advanced filtering
                </div>
                <div class="tile-stats">
                  <div class="tile-stat">
                    <span class="tile-stat-value" id="dash-stat-total">0</span>
                    <span class="tile-stat-label">Total</span>
                  </div>
                  <div class="tile-stat">
                    <span class="tile-stat-value" id="dash-stat-month">0</span>
                    <span class="tile-stat-label">This Month</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- SERVICE PAGE - Full Implementation -->
        <div id="service-page" class="page-content hidden">
          <div class="quality-dashboard" id="quality-dashboard">
            <div class="quality-header">
              <span>üìä Report Quality Score</span>
              <span id="quality-badge" class="badge badge-info">In Progress</span>
            </div>
            <div class="quality-score-large" id="quality-score-large">0%</div>
            <div class="quality-metrics">
              <div class="quality-metric">
                <div class="metric-value" id="metric-basic">0/5</div>
                <div class="metric-label">Basic Info</div>
              </div>
              <div class="quality-metric">
                <div class="metric-value" id="metric-diagnostics">0/3</div>
                <div class="metric-label">Diagnostics</div>
              </div>
              <div class="quality-metric">
                <div class="metric-value" id="metric-photos">0</div>
                <div class="metric-label">Photos</div>
              </div>
              <div class="quality-metric">
                <div class="metric-value" id="metric-signature">‚úó</div>
                <div class="metric-label">Signature</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">System Mode</div>
              <div class="toggle-group">
                <button class="toggle-btn active" id="mode-cooling" onclick="setSystemMode('cooling')">‚ùÑÔ∏è Cooling</button>
                <button class="toggle-btn" id="mode-heating" onclick="setSystemMode('heating')">üî• Heating</button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">Job Information</div></div>
            <div class="card-body">
              <div class="card-section">
                <label>Call Type</label>
                <div class="toggle-group">
                  <button class="toggle-btn active" id="call-trouble" onclick="setCallType('trouble')">Trouble Call</button>
                  <button class="toggle-btn" id="call-maintenance" onclick="setCallType('maintenance')">Maintenance</button>
                </div>
              </div>
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Customer Name</label>
                  <input type="text" id="customer-name" placeholder="Enter customer name" oninput="calculateQuality()">
                </div>
                <div class="form-group">
                  <label>Date</label>
                  <input type="date" id="service-date" oninput="calculateQuality()">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Service Address</label>
                  <input type="text" id="service-address" placeholder="123 Main St, City, State ZIP" oninput="calculateQuality()">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Customer Complaint / Reason for Service</label>
                  <textarea id="customer-complaint" placeholder="Describe the issue or maintenance reason..." oninput="calculateQuality()"></textarea>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">Equipment Information</div></div>
            <div class="card-body">
              <div class="form-grid">
                <div class="form-group">
                  <label>Unit Type</label>
                  <select id="unit-type" onchange="updateUnitFields(); calculateQuality();">
                    <option value="">Select unit type...</option>
                    <option value="split">Split System</option>
                    <option value="package">Package Unit</option>
                    <option value="mini-split">Mini-Split</option>
                    <option value="heat-pump">Heat Pump</option>
                  </select>
                </div>
              </div>
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Indoor Unit (Model/Serial)</label>
                  <input type="text" id="indoor-unit" placeholder="Model & Serial Number">
                </div>
                <div class="form-group" id="outdoor-unit-group">
                  <label>Outdoor Unit (Model/Serial)</label>
                  <input type="text" id="outdoor-unit" placeholder="Model & Serial Number">
                </div>
              </div>
              <div class="form-grid form-grid-3">
                <div class="form-group">
                  <label>Tonnage</label>
                  <select id="tonnage">
                    <option value="">Select...</option>
                    <option value="1.5">1.5 Ton</option>
                    <option value="2">2 Ton</option>
                    <option value="2.5">2.5 Ton</option>
                    <option value="3">3 Ton</option>
                    <option value="3.5">3.5 Ton</option>
                    <option value="4">4 Ton</option>
                    <option value="5">5 Ton</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Refrigerant Type<span class="help-icon" data-tooltip="R-410A is most common in modern systems">?</span></label>
                  <select id="refrigerant-type">
                    <option value="R410A">R-410A</option>
                    <option value="R22">R-22</option>
                    <option value="R454B">R-454B</option>
                    <option value="R32">R-32</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>Filter Size</label>
                  <input type="text" id="filter-size" placeholder="e.g., 16x25x1">
                </div>
              </div>
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Metering Device<span class="help-icon" data-tooltip="TXV adjusts automatically, Fixed Orifice does not">?</span></label>
                  <select id="metering-device" onchange="calculateDiagnostics()">
                    <option value="">Unknown</option>
                    <option value="txv">TXV (Thermostatic Expansion Valve)</option>
                    <option value="piston">Fixed Orifice / Piston</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>SEER Rating</label>
                  <input type="number" id="seer-rating" placeholder="e.g., 14">
                </div>
              </div>
            </div>
          </div>

          <div class="card" id="cooling-measurements">
            <div class="card-header"><div class="card-title">Diagnostic Measurements (Cooling Mode)</div></div>
            <div class="card-body">
              <div class="card-section">
                <div class="section-title">Temperature Readings</div>
                <div class="form-grid form-grid-4">
                  <div class="form-group">
                    <label>Outdoor Ambient (¬∞F)<span class="help-icon" data-tooltip="Temperature outside near condensing unit">?</span></label>
                    <input type="number" step="0.1" id="outdoor-ambient" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Indoor Temp (¬∞F)<span class="help-icon" data-tooltip="Temperature inside near return air">?</span></label>
                    <input type="number" step="0.1" id="ambient-temp" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Return Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="return-temp" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Supply Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="supply-temp" oninput="calculateDiagnostics()">
                  </div>
                </div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Delta-T (Calculated)<span class="help-icon" data-tooltip="Should be 16-22¬∞F for proper cooling">?</span></label>
                    <input type="text" id="delta-t" readonly>
                  </div>
                  <div class="form-group">
                    <label>Wet Bulb Temperature (¬∞F)<span class="help-icon" data-tooltip="Used for accurate charge verification">?</span></label>
                    <input type="number" step="0.1" id="wet-bulb" oninput="calculateDiagnostics()">
                  </div>
                </div>
              </div>
              
              <div class="card-section">
                <div class="section-title">Refrigerant Pressures & Temperatures</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Suction Pressure (PSI)</label>
                    <input type="number" step="0.1" id="suction-pressure" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Suction Line Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="suction-temp" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Liquid Pressure (PSI)</label>
                    <input type="number" step="0.1" id="liquid-pressure" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Liquid Line Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="liquid-temp" oninput="calculateDiagnostics()">
                  </div>
                </div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Superheat (Calculated)<span class="help-icon" data-tooltip="TXV: 8-15¬∞F | Fixed: 5-25¬∞F">?</span></label>
                    <input type="text" id="superheat" readonly>
                  </div>
                  <div class="form-group">
                    <label>Subcool (Calculated)<span class="help-icon" data-tooltip="Should be 8-12¬∞F for most systems">?</span></label>
                    <input type="text" id="subcool" readonly>
                  </div>
                </div>
              </div>
              
              <div class="card-section">
                <div class="section-title">Airflow & Electrical</div>
                <div class="form-grid form-grid-4">
                  <div class="form-group">
                    <label>Static Pressure (in w.c.)<span class="help-icon" data-tooltip="Total ESP should be ‚â§0.50 for residential">?</span></label>
                    <input type="number" step="0.01" id="static-pressure" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Voltage (V)</label>
                    <input type="number" step="0.1" id="voltage">
                  </div>
                  <div class="form-group">
                    <label>Amperage (A)<span class="help-icon" data-tooltip="Compressor running amps">?</span></label>
                    <input type="number" step="0.1" id="amperage">
                  </div>
                  <div class="form-group">
                    <label>RLA/FLA Rating<span class="help-icon" data-tooltip="From equipment nameplate">?</span></label>
                    <input type="number" step="0.1" id="rla-rating" placeholder="Nameplate">
                  </div>
                </div>
              </div>
              
              <div class="chart-container">
                <canvas id="pressure-chart"></canvas>
              </div>
            </div>
          </div>

          <div class="card hidden" id="heating-measurements">
            <div class="card-header"><div class="card-title">Diagnostic Measurements (Heating Mode)</div></div>
            <div class="card-body">
              <div class="card-section">
                <div class="section-title">Temperature Readings</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>Return Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="return-temp-heat" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Supply Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="supply-temp-heat" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Temp Rise (Calculated)<span class="help-icon" data-tooltip="Should be 35-65¬∞F for gas furnaces">?</span></label>
                    <input type="text" id="temp-rise" readonly>
                  </div>
                </div>
              </div>
              
              <div class="card-section">
                <div class="section-title">Gas Furnace / Heat Measurements</div>
                <div class="form-grid form-grid-4">
                  <div class="form-group">
                    <label>Manifold Pressure (in w.c.)<span class="help-icon" data-tooltip="Natural gas: 3.3-3.8 | LP: 10-11">?</span></label>
                    <input type="number" step="0.01" id="manifold-pressure" oninput="calculateDiagnostics()">
                  </div>
                  <div class="form-group">
                    <label>Voltage (V)</label>
                    <input type="number" step="0.1" id="voltage-heat">
                  </div>
                  <div class="form-group">
                    <label>Amperage (A)</label>
                    <input type="number" step="0.1" id="amperage-heat">
                  </div>
                  <div class="form-group">
                    <label>Gas Type</label>
                    <select id="gas-type">
                      <option value="natural">Natural Gas</option>
                      <option value="lp">LP/Propane</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <div class="chart-container">
                <canvas id="heating-chart"></canvas>
              </div>
            </div>
          </div>

          <div id="diagnostic-results" class="hidden"></div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">üì∏ Job Photos</div>
              <span class="badge badge-info" id="photo-count">0 photos</span>
            </div>
            <div class="card-body">
              <div class="photo-gallery" id="photo-gallery">
                <label class="photo-upload">
                  <input type="file" accept="image/*" capture="camera" multiple onchange="handlePhotos(event)" style="display:none">
                  <span style="font-size: 32px;">üì∑</span>
                  <span>Add Photo</span>
                </label>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">Findings & Work Performed</div></div>
            <div class="card-body">
              <div class="card-section">
                <div class="form-group">
                  <label>Findings</label>
                  <textarea id="findings" placeholder="Describe what you found during the service call..." oninput="calculateQuality()"></textarea>
                </div>
              </div>
              <div class="card-section">
                <div class="form-group">
                  <label>Recommendations</label>
                  <textarea id="recommendations" placeholder="What do you recommend to the customer?"></textarea>
                </div>
              </div>
              <div class="card-section">
                <div class="form-group">
                  <label>Work Performed</label>
                  <textarea id="work-performed" placeholder="Detail the work you completed..." oninput="calculateQuality()"></textarea>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">‚úçÔ∏è Customer Signature</div></div>
            <div class="card-body">
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Customer Name</label>
                  <input type="text" id="sig-name" placeholder="Customer name" oninput="calculateQuality()">
                </div>
                <div class="form-group">
                  <label>Date</label>
                  <input type="date" id="sig-date" oninput="calculateQuality()">
                </div>
              </div>
              <canvas id="signature-pad" class="signature-pad"></canvas>
              <div class="btn-group mt-lg">
                <button class="btn btn-secondary" onclick="clearSignature()">Clear</button>
                <button class="btn btn-primary" onclick="saveSignature()">Save Signature</button>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">Technician Information</div></div>
            <div class="card-body">
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Technician Name</label>
                  <input type="text" id="tech-name" value="Mart√≠n Perez">
                </div>
                <div class="form-group">
                  <label>Contact Phone</label>
                  <input type="tel" id="tech-phone" value="(346)451-0024">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Email Address</label>
                  <input type="email" id="tech-email" value="Mperez@villageplumbing.com">
                </div>
              </div>
            </div>
          </div>

          <div class="btn-group">
            <button class="btn btn-success" onclick="generatePDF()">üìÑ Generate PDF</button>
            <button class="btn btn-primary" onclick="generateTextReport()">üìã Text Report</button>
            <button class="btn btn-secondary" onclick="saveServiceData()">üíæ Save Progress</button>
            <button class="btn btn-danger" onclick="clearForm()">üóëÔ∏è Clear Form</button>
          </div>
        </div>

        <!-- MATERIALS PAGE - Full Implementation -->
        <div id="materials-page" class="page-content hidden">
          <div class="card">
            <div class="card-header"><div class="card-title">Job Information</div></div>
            <div class="card-body">
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Customer/Job Name</label>
                  <input type="text" id="mat-customer" placeholder="Enter customer or job name">
                </div>
                <div class="form-group">
                  <label>Date</label>
                  <input type="date" id="mat-date">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Job Address</label>
                  <input type="text" id="mat-address" placeholder="123 Main St, City, State ZIP">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Job Notes</label>
                  <textarea id="mat-notes" placeholder="Special instructions, access codes, etc."></textarea>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">üì¶ Materials Catalog - 2025 Complete Edition</div>
              <div class="btn-group">
                <button class="btn btn-secondary btn-sm" onclick="expandAllCategories()">Expand All</button>
                <button class="btn btn-secondary btn-sm" onclick="collapseAllCategories()">Collapse All</button>
              </div>
            </div>
            <div class="card-body">
              <div class="form-group">
                <input type="text" id="material-search" placeholder="üîç Search materials..." oninput="filterMaterials()" style="font-size: 15px;">
              </div>
              <div id="materials-catalog"></div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">Selected Materials</div>
              <span class="badge badge-info" id="selected-materials-count">0 items</span>
            </div>
            <div class="card-body">
              <div id="selected-materials">
                <div class="status-card info">‚ÑπÔ∏è No materials selected yet. Click size buttons to add materials to your list. You can add multiple sizes of the same item!</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header"><div class="card-title">Technician Information</div></div>
            <div class="card-body">
              <div class="form-grid form-grid-2">
                <div class="form-group">
                  <label>Technician Name</label>
                  <input type="text" id="mat-tech-name" value="Mart√≠n Perez">
                </div>
                <div class="form-group">
                  <label>Contact Phone</label>
                  <input type="tel" id="mat-tech-phone" value="(346)451-0024">
                </div>
              </div>
              <div class="form-grid">
                <div class="form-group">
                  <label>Email Address</label>
                  <input type="email" id="mat-tech-email" value="Mperez@villageplumbing.com">
                </div>
              </div>
            </div>
          </div>

          <div class="btn-group">
            <button class="btn btn-success" onclick="generateMaterialsPDF()">üìÑ Generate PDF</button>
            <button class="btn btn-primary" onclick="generateMaterialsReport()">üìã Generate List</button>
            <button class="btn btn-secondary" onclick="saveMaterialsData()">üíæ Save Progress</button>
            <button class="btn btn-danger" onclick="clearMaterialsForm()">üóëÔ∏è Clear Form</button>
          </div>
        </div>

        <!-- DUCT DESIGN PAGE -->
        <div id="duct-design-page" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">üèóÔ∏è Professional Duct Design System</div>
              <span class="badge badge-success">ACCA Manual D</span>
            </div>
            <div class="card-body">
              <div class="status-card info">
                <strong>Pro Duct Design Calculator</strong><br>
                Design complete ACCA Manual D compliant duct systems with automatic CFM distribution, friction rate calculations, and material takeoffs.
              </div>
              
              <div class="card-section">
                <div class="section-title">System Information</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>Total System CFM</label>
                    <input type="number" id="duct-total-cfm" placeholder="e.g., 1200">
                  </div>
                  <div class="form-group">
                    <label>Design Friction Rate<span class="help-icon" data-tooltip="0.06-0.10 in w.c. per 100 ft is typical">?</span></label>
                    <input type="number" step="0.01" id="duct-friction" value="0.08" placeholder="0.08">
                  </div>
                  <div class="form-group">
                    <label>System Type</label>
                    <select id="duct-system-type">
                      <option value="supply">Supply Only</option>
                      <option value="return">Return Only</option>
                      <option value="both">Supply & Return</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="card-section">
                <div class="section-title">Add Rooms/Zones</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>Room Name</label>
                    <input type="text" id="duct-room-name" placeholder="e.g., Master Bedroom">
                  </div>
                  <div class="form-group">
                    <label>Required CFM</label>
                    <input type="number" id="duct-room-cfm" placeholder="e.g., 150">
                  </div>
                  <div class="form-group">
                    <label>Run Length (ft)</label>
                    <input type="number" id="duct-room-length" placeholder="e.g., 25">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="addDuctRoom()">‚ûï Add Room</button>
              </div>

              <div class="card-section" id="duct-rooms-section">
                <div class="section-title">Configured Rooms</div>
                <div id="duct-rooms-list">
                  <div class="status-card info">No rooms added yet. Add rooms above to begin your duct design.</div>
                </div>
              </div>

              <div class="btn-group">
                <button class="btn btn-success" onclick="calculateDuctDesign()">üîß Calculate Design</button>
                <button class="btn btn-warning" onclick="clearDuctDesign()">Clear All</button>
              </div>

              <div id="duct-results" class="hidden"></div>
            </div>
          </div>
        </div>

        <!-- CFM CALCULATOR PAGE -->
        <div id="cfm-page" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">üå™Ô∏è CFM & Airflow Calculators</div>
            </div>
            <div class="card-body">
              <div class="form-group">
                <label>Select Calculator</label>
                <select id="cfm-calculator-type" onchange="showCFMCalculator()">
                  <option value="tonnage">CFM from Tonnage</option>
                  <option value="btu">CFM from BTU</option>
                  <option value="deltaT">CFM from Delta-T</option>
                  <option value="velocity">Velocity & Duct Sizing</option>
                  <option value="static">Static Pressure Loss</option>
                  <option value="fpm">FPM to CFM Conversion</option>
                </select>
              </div>

              <!-- CFM from Tonnage -->
              <div id="cfm-tonnage" class="card-section">
                <div class="section-title">CFM from Tonnage Calculator</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>System Tonnage</label>
                    <input type="number" step="0.5" id="cfm-ton-input" placeholder="e.g., 3.5">
                  </div>
                  <div class="form-group">
                    <label>CFM per Ton<span class="help-icon" data-tooltip="Standard is 400 CFM/ton">?</span></label>
                    <input type="number" id="cfm-ton-rate" value="400" placeholder="400">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateCFMFromTonnage()">Calculate</button>
                <div id="cfm-tonnage-result"></div>
              </div>

              <!-- CFM from BTU -->
              <div id="cfm-btu" class="card-section hidden">
                <div class="section-title">CFM from BTU Calculator</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>BTU/hr</label>
                    <input type="number" id="cfm-btu-input" placeholder="e.g., 36000">
                  </div>
                  <div class="form-group">
                    <label>Delta-T (¬∞F)</label>
                    <input type="number" id="cfm-btu-deltat" value="20" placeholder="20">
                  </div>
                  <div class="form-group">
                    <label>Air Density (lb/ft¬≥)</label>
                    <input type="number" step="0.001" id="cfm-btu-density" value="0.075" placeholder="0.075">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateCFMFromBTU()">Calculate</button>
                <div id="cfm-btu-result"></div>
              </div>

              <!-- CFM from Delta-T -->
              <div id="cfm-deltaT" class="card-section hidden">
                <div class="section-title">CFM from Temperature Drop</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>Return Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="cfm-dt-return" placeholder="e.g., 75">
                  </div>
                  <div class="form-group">
                    <label>Supply Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="cfm-dt-supply" placeholder="e.g., 55">
                  </div>
                  <div class="form-group">
                    <label>Cooling Capacity (BTU)</label>
                    <input type="number" id="cfm-dt-btu" placeholder="e.g., 36000">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateCFMFromDeltaT()">Calculate</button>
                <div id="cfm-dt-result"></div>
              </div>

              <!-- Velocity & Duct Sizing -->
              <div id="cfm-velocity" class="card-section hidden">
                <div class="section-title">Velocity & Duct Sizing Calculator</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Required CFM</label>
                    <input type="number" id="cfm-vel-cfm" placeholder="e.g., 400">
                  </div>
                  <div class="form-group">
                    <label>Target Velocity (FPM)<span class="help-icon" data-tooltip="Supply trunk: 900-1200, branches: 600-900">?</span></label>
                    <input type="number" id="cfm-vel-fpm" placeholder="e.g., 900">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateVelocityAndSize()">Calculate</button>
                <div id="cfm-velocity-result"></div>
              </div>

              <!-- Static Pressure Loss -->
              <div id="cfm-static" class="card-section hidden">
                <div class="section-title">Static Pressure Loss Calculator</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>CFM</label>
                    <input type="number" id="cfm-sp-cfm" placeholder="e.g., 1200">
                  </div>
                  <div class="form-group">
                    <label>Duct Diameter (inches)</label>
                    <input type="number" id="cfm-sp-dia" placeholder="e.g., 16">
                  </div>
                  <div class="form-group">
                    <label>Duct Length (ft)</label>
                    <input type="number" id="cfm-sp-length" placeholder="e.g., 50">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateStaticPressure()">Calculate</button>
                <div id="cfm-static-result"></div>
              </div>

              <!-- FPM to CFM -->
              <div id="cfm-fpm" class="card-section hidden">
                <div class="section-title">FPM to CFM Conversion</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Velocity (FPM)</label>
                    <input type="number" id="cfm-fpm-input" placeholder="e.g., 900">
                  </div>
                  <div class="form-group">
                    <label>Duct Area (sq ft)</label>
                    <input type="number" step="0.01" id="cfm-fpm-area" placeholder="e.g., 1.23">
                  </div>
                </div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>OR: Round Duct Diameter (inches)</label>
                    <input type="number" id="cfm-fpm-dia" placeholder="e.g., 16" oninput="calculateFPMArea('round')">
                  </div>
                  <div class="form-group">
                    <label>OR: Rectangular Duct (inches)</label>
                    <input type="text" id="cfm-fpm-rect" placeholder="e.g., 12x8" oninput="calculateFPMArea('rect')">
                  </div>
                </div>
                <button class="btn btn-primary" onclick="calculateFPMtoCFM()">Calculate</button>
                <div id="cfm-fpm-result"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- REFRIGERANT CHARGING PAGE -->
        <div id="charging-page" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">‚ùÑÔ∏è Refrigerant Charging Calculator</div>
            </div>
            <div class="card-body">
              <div class="status-card info">
                <strong>Professional Refrigerant Charging Assistant</strong><br>
                Calculate target superheat and subcool values based on system conditions and metering device type.
              </div>

              <div class="card-section">
                <div class="section-title">System Configuration</div>
                <div class="form-grid form-grid-3">
                  <div class="form-group">
                    <label>Refrigerant Type</label>
                    <select id="charge-refrigerant">
                      <option value="R410A">R-410A</option>
                      <option value="R22">R-22</option>
                      <option value="R454B">R-454B</option>
                      <option value="R32">R-32</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Metering Device</label>
                    <select id="charge-metering">
                      <option value="txv">TXV</option>
                      <option value="piston">Fixed Orifice/Piston</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Outdoor Ambient (¬∞F)</label>
                    <input type="number" id="charge-outdoor-temp" placeholder="e.g., 95">
                  </div>
                </div>
              </div>

              <div class="card-section">
                <div class="section-title">Current Measurements</div>
                <div class="form-grid form-grid-2">
                  <div class="form-group">
                    <label>Suction Pressure (PSI)</label>
                    <input type="number" step="0.1" id="charge-suction-psi">
                  </div>
                  <div class="form-group">
                    <label>Suction Line Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="charge-suction-temp">
                  </div>
                  <div class="form-group">
                    <label>Liquid Pressure (PSI)</label>
                    <input type="number" step="0.1" id="charge-liquid-psi">
                  </div>
                  <div class="form-group">
                    <label>Liquid Line Temp (¬∞F)</label>
                    <input type="number" step="0.1" id="charge-liquid-temp">
                  </div>
                </div>
              </div>

              <button class="btn btn-success" onclick="calculateRefrigerantCharge()">üî¨ Analyze Charge</button>

              <div id="charge-results" class="hidden"></div>
            </div>
          </div>
        </div>

        <!-- HISTORY PAGE -->
        <div id="history-page" class="page-content hidden">
          <div class="card">
            <div class="card-header">
              <div class="card-title">üìä Saved Reports & History</div>
              <button class="btn btn-primary" onclick="refreshHistory()">Refresh</button>
            </div>
            <div class="card-body">
              <div id="history-list">
                <div class="status-card info">
                  ‚ÑπÔ∏è No saved reports yet. Complete a service call and save your progress to see history here.
                </div>
              </div>
            </div>
          </div>
          
          <div class="card">
            <div class="card-header">
              <div class="card-title">üìà Statistics</div>
            </div>
            <div class="card-body">
              <div class="quality-metrics">
                <div class="quality-metric" style="background: var(--bg-elevated); border: 1px solid var(--glass-border);">
                  <div class="metric-value" style="color: var(--accent-primary);" id="stat-total">0</div>
                  <div class="metric-label">Total Reports</div>
                </div>
                <div class="quality-metric" style="background: var(--bg-elevated); border: 1px solid var(--glass-border);">
                  <div class="metric-value" style="color: var(--accent-secondary);" id="stat-this-month">0</div>
                  <div class="metric-label">This Month</div>
                </div>
                <div class="quality-metric" style="background: var(--bg-elevated); border: 1px solid var(--glass-border);">
                  <div class="metric-value" style="color: var(--success);" id="stat-avg-quality">0%</div>
                  <div class="metric-label">Avg Quality</div>
                </div>
                <div class="quality-metric" style="background: var(--bg-elevated); border: 1px solid var(--glass-border);">
                  <div class="metric-value" style="color: var(--info);" id="stat-photos">0</div>
                  <div class="metric-label">Total Photos</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <div class="toast" id="toast"></div>
  
  <div class="modal-overlay" id="modal-overlay">
    <div class="modal">
      <div class="modal-title" id="modal-title">Confirm Action</div>
      <div class="modal-content" id="modal-content">Are you sure?</div>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeModal(false)">Cancel</button>
        <button class="btn btn-primary" onclick="closeModal(true)">Confirm</button>
      </div>
    </div>
  </div>

  <script>

